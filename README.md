# ufebs-reader
read&amp;write ufebs file Bank Russia
Программа для просмотра-редактирования-выборок из файлов в формате УФЕБС ( БанкРоссии )

Программа открывает для просмотра и редактирования файл документов УФЕБС\n
 - Умеет менять идентификаторы документов и   переделывать файл на другую дату
 - Встроен XPATH анализ
 - можно использовать как кодер-декодер BASE64
 - Умеет анализировать по маскам счетов наличие документов  на КЗ УПД
 - Умеет дробить PacketEPD на отдельные документы ED101   и затем собирать новый пакет, включая в него только нужные
Ключи:
-$ изменять сумму
-l включить логирование
-E изменять номера EDNo 
-e не изменять номера EDNo  
-B сжмать пробелы 
-b не сжмать пробелы 
-A изменять номера AccDocNo  
-a не изменять номера AccDocNo
-R пересчитать суммы 
-r не пересчитать суммы  
-f сокращенное меню
-F полное меню
-5 двойная распаковка для ED501
-5- нет двойной распаковки для ED501
-0


07.05.2015
 - доработано логирование действий
 - лог теперь пишется в уникальный файл типа ur_DD-MM-YYYY.log
 - убрал комментирование действий из заголовка окна
 - теперь в заголовке имя загруженного файла
 - флаги настроек переведены в единый массив и чекаются не по одиночке, а в цикле


21.04.2015
 меню настроек-блок Выборок теперь строится динамически
 из rules.h
 //TODO  конфиг rules.h подменять из командной строки, так же как в chdatexml 


16.04.2015
 Добавлен блок настроек для XML
 Можно проставить крыжи "Удалять 40817" , "Удалять 423"
 Если крыжи проставлены , то операция "Выборка ED101" cоответственно удалит платежки
 в которых PersonalAcc проставлен в 40817 либо 423


01.04.2015
 Добавлена операция "Выделить SWIFTDocument(ED503)" для просмотра ED503
 Показывает первый SWIFTDocument из файла ( таких документов может быть несколько,
    но сейчас программа показывает первый из них)
 Можно использовать для просмотра , но запускать 
 с командной строки надо с ключом -0
    ur -0 ED501XXXX.ED
 иначе крэш на проверке ED501
 



03.03.2015

Добавлена операция "Пересборка PacketEPD"

  При выполнении операции  пакет разваливается на отдельные ED101, затем собирается 

  в новый используя  правила из файла  rules.h 



//////////  Правила обработки ED101 /////////////////////////

struct rule_descr rules[8] = {

 { ":Payee:PersonalAcc" , "40817810[0-9]06" , _WRITE_ED101_ , NULL }  ,

 { ":Payee:PersonalAcc" , "408[12][027]"      , _SKIP_ED101_ , NULL }  ,

 { ":Payer:PersonalAcc" , "40702810[0-9]0634" , _WRITE_ED101_ , NULL }  ,

 { ":Payee:PersonalAcc" , "42[34]0"       , _SKIP_ED101_ , NULL }  ,

 { ":Payee:Bank:BIC"    , "048073601"     , _SKIP_ED101_ , NULL },{NULL,NULL,0,NULL}} ;

////////////////////////////////////////////////////////////////



То есть в новый пакет включаются только платежки, которые попадают 

под правило WRITE, а те что попадают под SKIP - игнорируются и в новый 

пакет не включаются

Таким образом строится пакет не содержащий платежки которые могут пойти на ЦОД







25.02.2015
   Добавлен пункт "Xpath поиск"
   Можно ввести XPATH выражения типа 
      "/my:PacketEPD/my:ED101[@EDAuthor="7195753000"]"
   или 
      /my:PacketEPD/my:ED101/my:Payee[@PersonalAcc="40802810017000180048"]
   и получить сколько данных документов найдено в пакете
   AHTUNG! если XPATH построен некорректно будет крэш







18.02.2015
разбор параметров командной строки для установки глобальных флагов



16.02.2015
 добавлен функционал распознавания ED501
 при запуске с командной строки
 программа после распаковки попытается определить - не ED501 ли это ?
 если ED501 - то выделит и распакует ProprietoryDocument
 работает через xpath - запускать только на корректных XML 
 на простом тексте будет крэш





16.01.2015
 добавлен функционал анализа на документы предположительно 
 смаршрутизирующиеся на УПД 
 работает через xpath - запускать только на корректных XML 
 на простом тексте будет крэш

21.12.14
 Добавлен функционал пересчета количества и суммы в PacketEPD
 меняет тэги EDQuantity и Sum
 работает через xpath

 создает в текущем каталоге временный файл !bout.txt,если нет прав - будет 
 ошибка.
 использовать с осторожностью




